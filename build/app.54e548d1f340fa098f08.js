"use strict";(self.webpackChunkpb_connect=self.webpackChunkpb_connect||[]).push([[524],{6650:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ht});var r=n(6540),a=n(5793),i=n(7254),o=n(9067),l=n(1406),c=n(3333),s=n(5878),d=n(4279);const u=e=>({fontFamily:['"Inter"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif"].join(","),h5:{fontWeight:700},h6:{fontWeight:700},button:{fontWeight:600,textTransform:"Capitalize"},body1Bold:{fontSize:"1rem",lineHeight:"1.5",letterSpacing:"0.00938em",fontWeight:600},caption2:{fontSize:10,fontStyle:"normal",fontWeight:400,lineHeight:"normal",color:(0,d.X4)(e.text.primary,.45)}}),m=(e,t)=>{const n={containedPrimary:e.primary.main,containedSecondary:e.secondary.main,containedError:e.error.main,containedWarning:e.warning.main,containedInfo:e.info.main,containedSuccess:e.success.main};return{[t]:{"&:disabled":{backgroundColor:(0,d.X4)(n[t],.54),color:e.common.white}}}},p=e=>({styleOverrides:{root:{padding:"0.875rem 2rem"},contained:{},...m(e,"containedPrimary"),...m(e,"containedSecondary"),...m(e,"containedError"),...m(e,"containedWarning"),...m(e,"containedInfo"),...m(e,"containedSuccess"),outlined:{background:"".concat(e.common.white," !important")},text:{background:"".concat(e.common.white," !important")}},defaultProps:{disableElevation:!0}}),f=e=>({styleOverrides:{root:{background:e.background.paper,color:e.text.primary,padding:"16px 32px",borderBottom:"1px solid ".concat((0,d.X4)(e.common.black,.12)),justifyContent:"space-between",alignItems:"center",flexDirection:"row"}},defaultProps:{elevation:0}}),h=e=>({styleOverrides:{root:{"& .MuiInputBase-root, & .MuiInputLabel-root":{fontSize:14},"& .MuiInputLabel-root.MuiInputLabel-shrink":{transform:"translate(14px, -6px) scale(0.75)"},"& .Mui-disabled":{WebkitTextFillColor:"".concat(e.text.primary," !important"),cursor:"not-allowed !important"}}},defaultProps:{}});var g=n(6862);const E=e=>({styleOverrides:{root:{fontSize:14,"& .Mui-disabled":{WebkitTextFillColor:"".concat(e.text.primary," !important"),cursor:"not-allowed !important"}}},defaultProps:{IconComponent:g.A,MenuProps:{PaperProps:{sx:{maxHeight:250}}}}}),A=e=>({styleOverrides:{root:{width:28,height:16,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(12px)",color:e.common.white,"& + .MuiSwitch-track":{backgroundColor:e.primary.main,opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:e.primary.main,border:"6px solid ".concat(e.common.white)},"&.Mui-disabled .MuiSwitch-thumb":{color:e.grey[100]},"&.Mui-disabled + .MuiSwitch-track":{opacity:.7}},"& .MuiSwitch-thumb":{boxSizing:"border-box",boxShadow:"none",width:12,height:12},"& .MuiSwitch-track":{borderRadius:8,backgroundColor:(0,d.X4)(e.text.primary,.5),opacity:1,transition:"background-color 500ms"}}},defaultProps:{}}),b=e=>({styleOverrides:{root:{},body:{borderBottom:"none"},head:{borderBottom:"1px solid ".concat((0,d.X4)(e.text.primary,.1)),paddingBottom:11}},defaultProps:{}}),v=e=>({styleOverrides:{root:t=>{let{theme:n}=t;return{"&:nth-of-type(even)":{backgroundColor:(0,d.X4)(e.secondary.main,.02)},"&:hover":{background:"linear-gradient(90deg, ".concat((0,d.X4)(e.secondary.main,0)," 1.84%, ").concat((0,d.X4)(e.secondary.main,.19)," 28.06%)")},"td:first-of-type":{borderTopLeftRadius:"".concat(n.shape.borderRadius,"px"),borderBottomLeftRadius:"".concat(n.shape.borderRadius,"px")},"td:last-of-type":{borderTopRightRadius:"".concat(n.shape.borderRadius,"px"),borderBottomRightRadius:"".concat(n.shape.borderRadius,"px")}}}},defaultProps:{}});var y=n(504);const x=80,S="#F2F1FC",w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"hidden",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"fixed",c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"launcher";return{borderRadius:"".concat(e.shape.borderRadius,"px"),zIndex:1e9,position:l,bottom:r,[t]:n,minWidth:80,minHeight:x,width:a,height:i,overflow:o,background:"detail"===c?"linear-gradient(90deg, rgba(255, 255, 255, 0.20) 1.1%, rgba(255, 255, 255, 0.40) 99.77%)":S,..."detail"===c&&{backdropFilter:"blur(20px)"}}};var C=n(2543);const k=e=>"".concat("https://pingbaselrsstorage.blob.core.windows.net/pingbase-client/assets/").concat((0,C.trimStart)(e,"/")),T=k("videos/widget/ManWaving.mp4"),R=k("videos/widget/WomanWaving.mp4"),P=function(){const e=(0,y.A)((e=>e.widgetDetailOpen)),t=(0,y.A)((e=>e.setWidgetDetailOpen)),n=(0,y.A)((e=>e.launcherAvatar)),a={1:T,2:R};return r.createElement(o.A,{sx:e=>(e=>({...w(e,y.A.getState().widgetPosition,20,20,80,x,"hidden"),cursor:y.A.getState().widgetDetailOpen?"default":"pointer",boxShadow:"0px 0px 12px 0px rgba(13, 12, 34, 0.32)"}))(e),onClick:()=>{e||t(!0)}},r.createElement(o.A,{component:"video",src:a[n],autoPlay:!0,muted:!0,loop:!0,style:{width:"100%",height:"100%",objectFit:"cover"}}))};var M=n(2222),I=n(9521),W=n(4073);function U(e){const{label:t,background:n,color:a}=e;return r.createElement(M.A,{height:16,px:.5,alignItems:"center",justifyContent:"center",borderRadius:8,fontSize:12,fontWeight:700,minWidth:22,sx:{background:e=>n&&n(e),color:e=>a&&a(e)}},t)}U.defaultProps={background:e=>e.palette.secondary.main,color:e=>e.palette.common.white};const B=U,z=e=>({...w(e,y.A.getState().widgetPosition,20,20,80,x,"hidden"),cursor:y.A.getState().widgetDetailOpen?"default":"pointer",boxShadow:"0px 0px 12px 0px rgba(13, 12, 34, 0.32)"});function D(e){const{icon:t,description:n,badgeCount:a,onClick:i}=e;return r.createElement(M.A,{direction:"row",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",position:"relative",p:2,spacing:2,onClick:i},r.createElement(M.A,{height:"100%",sx:{aspectRatio:1},alignItems:"center",justifyContent:"center"},t),Boolean(n)&&r.createElement(W.A,{variant:"body2",maxWidth:100},n),Boolean(a)&&r.createElement(o.A,{sx:{position:"absolute",top:5,right:5}},r.createElement(B,{label:a})))}D.defaultProps={badgeCount:null,description:null};const O=D,L=function(e){const{children:t,color1:n,color2:a}=e;return r.createElement(M.A,{sx:{background:e=>"linear-gradient(".concat(S,", ").concat(S,") padding-box, linear-gradient(to bottom, ").concat(n(e),", ").concat(a(e),") border-box"),border:"2px solid transparent",borderRadius:e=>{let{shape:t}=e;return"".concat(t.borderRadius,"px")}},width:"100%",height:"100%"},t)},j=function(){const e=(0,y.A)((e=>e.widgetDetailOpen)),t=(0,y.A)((e=>e.setWidgetDetailOpen)),n=(0,y.A)((e=>e.newUnreadEventsCount));return r.createElement(M.A,{sx:e=>({...z(e)}),onClick:()=>{e||t(!0)}},r.createElement(L,{color1:e=>{let{palette:t}=e;return t.primary.main},color2:e=>{let{palette:t}=e;return t.secondary.main}},r.createElement(O,{icon:r.createElement(I.A,{color:"primary",sx:{width:"100%",height:"100%"}}),badgeCount:n,onClick:()=>{}})))};var N=n(6707);const _=function(){const e=(0,y.A)((e=>e.widgetDetailOpen)),t=(0,y.A)((e=>e.setWidgetDetailOpen)),n=(0,y.A)((e=>e.newUnreadEventsCount));return r.createElement(M.A,{sx:e=>({...z(e)}),onClick:()=>{e||t(!0)}},r.createElement(L,{color1:e=>{let{palette:t}=e;return t.error.main},color2:e=>{let{palette:t}=e;return t.secondary.main}},r.createElement(O,{icon:r.createElement(N.A,{color:"error",sx:{width:"100%",height:"100%"}}),badgeCount:n,onClick:()=>{}})))};var F=n(4285);const V=function(){return r.createElement(M.A,{sx:e=>({...z(e)})},r.createElement(L,{color1:e=>{let{palette:t}=e;return t.primary.main},color2:e=>{let{palette:t}=e;return t.secondary.main}},r.createElement(O,{icon:r.createElement(F.A,{color:"primary",sx:{width:"100%",height:"100%"}}),onClick:()=>{}})))};var X=n(2561);const H=function(){return r.createElement(M.A,{sx:e=>({...z(e)})},r.createElement(L,{color1:e=>{let{palette:t}=e;return t.primary.main},color2:e=>{let{palette:t}=e;return t.secondary.main}},r.createElement(O,{icon:r.createElement(X.A,{color:"primary",sx:{width:"100%",height:"100%"}}),onClick:()=>{}})))};var J=n(1832);const Y=function(){const e=(0,y.A)((e=>e.setWidgetLauncher)),t=(0,y.A)((e=>e.setWidgetDetailOpen));(0,r.useEffect)((()=>{t(!1);const n=setTimeout((()=>{e("ringing"),t(!0)}),1e4);return()=>clearTimeout(n)}),[]);const n=(0,y.A)((e=>e.newUnreadEvent));return(0,r.useEffect)((()=>{"MissedCall"===(null==n?void 0:n.type)&&(t(!1),e("default"))}),[n]),r.createElement(M.A,{sx:e=>({...z(e),width:"fit-content"})},r.createElement(L,{color1:e=>{let{palette:t}=e;return t.primary.main},color2:e=>{let{palette:t}=e;return t.secondary.main}},r.createElement(O,{icon:r.createElement(J.A,{color:"primary",sx:{width:"100%",height:"100%"}}),description:"Youâ€™re about to receive a call...",onClick:()=>{}})))};var q=n(4196);const K=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,r.useRef)(null),a=(0,r.useRef)(!1);return(0,r.useEffect)((()=>(n.current=new q.Howl({src:[e],loop:t.loop||!1,volume:t.volume||1,rate:t.rate||1,onplay:()=>{var e;a.current=!0,null===(e=t.onPlay)||void 0===e||e.call(t)},onstop:()=>{var e;a.current=!1,null===(e=t.onStop)||void 0===e||e.call(t)},onend:()=>{var e;a.current=!1,null===(e=t.onEnd)||void 0===e||e.call(t)}}),()=>{n.current&&n.current.unload()})),[e,t.loop,t.volume,t.rate,t.onPlay,t.onStop,t.onEnd]),{playSound:()=>{t.preventReplay&&a.current||n.current&&(n.current.seek(0),n.current.play())},stopSound:()=>{n.current&&n.current.stop()},resetSound:()=>{n.current&&n.current.seek(0)}}},Q=function(){const e=K("https://cdn.pixabay.com/download/audio/2022/11/20/audio_662f2ae340.mp3?filename=ringtone-126505.mp3",{loop:!0,preventReplay:!0}),t=((0,y.A)((e=>e.widgetDetailOpen)),(0,y.A)((e=>e.setWidgetDetailOpen))),n=(0,y.A)((e=>e.setWidgetLauncher)),a=(0,y.A)((e=>e.launcherAvatar)),i={1:T,2:R},l=(0,y.A)((e=>e.newUnreadEvent));return(0,r.useEffect)((()=>{"MissedCall"===(null==l?void 0:l.type)&&(t(!1),n("default"))}),[l]),(0,r.useEffect)((()=>(e.playSound(),()=>{e.stopSound()})),[]),r.createElement(o.A,{sx:e=>(e=>({...w(e,y.A.getState().widgetPosition,20,20,80,x,"hidden"),cursor:y.A.getState().widgetDetailOpen?"default":"pointer",boxShadow:"0px 0px 12px 0px rgba(13, 12, 34, 0.32)"}))(e)},r.createElement(o.A,{component:"video",src:i[a],autoPlay:!0,muted:!0,loop:!0,style:{width:"100%",height:"100%",objectFit:"cover"}}))},G=function(){switch((0,y.A)((e=>e.widgetLauncher))){case"default":case"declinedIncomingCall":return r.createElement(P,null);case"voiceNote":return r.createElement(j,null);case"missedCall":return r.createElement(_,null);case"voiceRecording":return r.createElement(H,null);case"aboutToReceiveCall":return r.createElement(Y,null);case"timeline":return r.createElement(V,null);case"ringing":return r.createElement(Q,null);default:return null}};var Z=n(6990),$=n(1031),ee=n(3753),te=n(2862),ne=n(2480),re=n(4479);function ae(e){const{hideCallBtn:t,hideTimelineBtn:n,onCallBtnClick:a,onScheduleBtnClick:i,onVoiceNoteBtnClick:l,onTimelineBtnClick:c}=e,s=(0,y.A)((e=>e.setWidgetLauncher)),d=(0,y.A)((e=>e.setWidgetDetailOpen)),u=(0,re.A)((e=>e.startMeeting)),m=(0,y.A)((e=>e.teamName)),p=(0,y.A)((e=>e.timelineUnreadEventsCount)),f=(0,y.A)((e=>e.fetchUnreadEvents)),h=(0,y.A)((e=>e.setTimelineUnreadEventsCount));return(0,r.useEffect)((()=>(n||f(),()=>{h(0)})),[]),r.createElement(M.A,{direction:"row",spacing:2,p:0,height:"100%",alignItems:"center",justifyContent:"center",position:"relative"},!t&&r.createElement(Z.A,{variant:"contained",sx:{height:36,fontWeight:500,px:2},startIcon:r.createElement($.A,null),onClick:()=>{null==a||a(),u("post"),s("inCall")}},"Call ",m),r.createElement(Z.A,{variant:"outlined",sx:{height:36,fontWeight:500,px:2},startIcon:r.createElement(ee.A,null),onClick:()=>{null==i||i(),window.open("https://calendly.com/suraksha-2","_blank"),d(!1),s("default")}},"Schedule Call"),r.createElement(Z.A,{variant:"outlined",sx:{height:36,fontWeight:500,px:2},startIcon:r.createElement(te.A,null),onClick:()=>{null==l||l(),s("voiceRecording")}},"Send Voice Note"),!n&&r.createElement(Z.A,{variant:"outlined",color:"inherit",sx:{height:36,fontWeight:500,px:2},startIcon:r.createElement(ne.A,null),onClick:()=>{null==c||c(),s("timeline")}},"Timeline",Boolean(p)&&r.createElement(o.A,{ml:1,mr:-.5},r.createElement(B,{label:p,background:e=>{let{palette:t}=e;return t.primary.main}}))))}ae.defaultProps={hideCallBtn:!1,hideTimelineBtn:!1,onCallBtnClick:null,onScheduleBtnClick:null,onVoiceNoteBtnClick:null,onTimelineBtnClick:null};const ie=ae;var oe=n(8068);const le=e=>({...w(e,y.A.getState().widgetPosition,108,20,"fit-content",x,"visible","fixed","detail"),border:"1px solid ".concat(e.palette.divider)}),ce=function(){const e=(0,y.A)((e=>e.setWidgetDetailOpen)),t=(0,y.A)((e=>e.setWidgetLauncher));return r.createElement(M.A,{sx:e=>({...le(e)}),alignItems:"center",justifyContent:"center",direction:"row"},r.createElement(M.A,{p:2,height:"100%",position:"relative",justifyContent:"space-between"},r.createElement(ie,null),r.createElement(oe.A,{onCloseDetail:()=>{e(!1),t("default")}})))};var se=n(4203),de=n(2717),ue=n(6526),me=n(8947),pe=n(3572),fe=n(8971),he=n(4675),ge=n(6398),Ee=n(2598);const Ae=e=>{const t=Number(e.toFixed(0)),n=Math.floor(t/3600);let r=Math.floor(t/60%60),a=t%60;const i=n<10?"0".concat(n):n;return r=r<10?"0".concat(r):r,a=a<10?"0".concat(a):a,"".concat(n?"".concat(i,":"):"").concat(r,":").concat(a)};!function(){const e=[];for(let t=0;t<24;t+=1)for(let n=0;n<60;n+=30){const r=t<12?"AM":"PM",a="".concat(t%12==0?12:t%12,":").concat(n<10?"0":"").concat(n," ").concat(r);e.push(a)}}();const be=function(e){const{recordingTime:t,mediaRecorder:n}=e,a=(0,he.A)();return r.createElement(M.A,{width:260,direction:"row",px:2,py:.5,alignItems:"center",justifyContent:"space-between",sx:{borderRadius:e=>{let{shape:t}=e;return"".concat(t.borderRadius,"px")},background:e=>{let{palette:t}=e;return(0,d.X4)(t.secondary.main,.1)},opacity:n?1:.5}},r.createElement(M.A,{direction:"row",flex:1},n?r.createElement(Ee.r,{mediaRecorder:n,width:140,height:24,barWidth:2,gap:2,fftSize:512,maxDecibels:-10,minDecibels:-80,smoothingTimeConstant:.8,barColor:a.palette.text.primary}):r.createElement(M.A,{direction:"row",flex:1},r.createElement(ge.A,null))),r.createElement(W.A,{variant:"h6"},Ae(t)))};var ve=n(1641),ye=n(1015),xe=n(8104),Se=n(5024),we=n(9696),Ce=n(7149),ke=n(6982);function Te(e){var t;const{audioSrc:n,autoPlay:a,audioType:i,isCurrentPlaying:l,index:c,hideVolumeSlider:s,onPlay:u,onStop:m,onClose:p,defaultCurrentTime:f,setDefaultCurrentTime:h}=e,g=(0,r.useRef)(null),[E,A]=(0,r.useState)(!1),[b,v]=(0,r.useState)(f||0),[x,S]=(0,r.useState)(0),[w,C]=(0,r.useState)(0),[k,T]=(0,r.useState)(!1),R=(0,y.A)((e=>e.userVolume)),P=(0,y.A)((e=>e.setUserVolume));return(0,r.useEffect)((()=>{var e;if(l){if(!E&&a){var t;null==g||null===(t=g.current)||void 0===t||t.play(),A(!0)}}else null==g||null===(e=g.current)||void 0===e||e.pause(),A(!1)}),[l]),(0,r.useEffect)((()=>{"blob"===i&&(0,ke.A)(n).then((e=>{S(e)}))}),[n]),(0,r.useEffect)((()=>{var e;x||"blob"===i||S((null==g||null===(e=g.current)||void 0===e?void 0:e.duration)||0)}),[null==g||null===(t=g.current)||void 0===t?void 0:t.duration]),(0,r.useEffect)((()=>{g.current&&!s&&(g.current.volume=R/100)}),[R]),(0,r.useEffect)((()=>{x&&!k&&(f&&g.current&&(v(f),g.current.currentTime=f,C(100*f/x)),T(!0))}),[x,k]),r.createElement(M.A,{direction:"row",spacing:.5,borderRadius:e=>"".concat(e.shape.borderRadius,"px"),sx:{background:e=>{let{palette:t}=e;return(0,d.X4)(t.secondary.main,.1)}},alignItems:"center",width:"100%",pr:1},r.createElement(o.A,{id:"end-user-audio-element-".concat(c),component:"audio",ref:g,src:n,onTimeUpdate:()=>{g.current&&(v(g.current.currentTime),h&&h(g.current.currentTime),C(100*g.current.currentTime/x))},onEnded:()=>{var e;g.current&&(null==g||null===(e=g.current)||void 0===e||e.pause()),A(!1),m()},onLoadedData:()=>{g.current&&"blob"!==i&&S(g.current.duration)}}),r.createElement(ve.A,{onClick:()=>{var e,t;E?(null==g||null===(e=g.current)||void 0===e||e.pause(),A(!1)):(null==g||null===(t=g.current)||void 0===t||t.play(),u(c),A(!0))}},l&&E?r.createElement(Se.A,{color:"secondary"}):r.createElement(xe.A,{color:"secondary"})),r.createElement(ye.Ay,{value:w,onChange:(e,t)=>{if(g.current){const e=t*x/100;g.current.currentTime=e}},sx:{flexBasis:"40%"},color:"secondary"}),r.createElement(W.A,{variant:"body2"},Ae(x-b)),r.createElement(M.A,{direction:"row",alignItems:"center",justifyContent:"end",flex:1,spacing:.75},!s&&r.createElement(r.Fragment,null,r.createElement(Ce.A,null),r.createElement(ye.Ay,{value:R,onChange:(e,t)=>{P(t)},sx:{flex:1,maxWidth:42},color:"secondary",disabled:!E})),Boolean(p)&&r.createElement(ve.A,{onClick:p,size:"small"},r.createElement(we.A,{color:"secondary",sx:{width:16,height:16}}))))}Te.defaultProps={audioType:"url",hideVolumeSlider:!1,onClose:null,defaultCurrentTime:0,autoPlay:!1,setDefaultCurrentTime:null};const Re=Te,Pe=function(e){const{audioSrc:t}=e,n={id:"1",src:t},[a,i]=(0,r.useState)(null);return r.createElement(M.A,{width:260},r.createElement(Re,{audioSrc:n.src,audioType:"blob",isCurrentPlaying:a===n.id,index:n.id,onPlay:e=>i(e),onStop:()=>i(null)}))};var Me=n(2382);const Ie=function(){const e=(0,y.A)((e=>e.setWidgetDetailOpen)),t=(0,y.A)((e=>e.setWidgetLauncher)),n=()=>{e(!1),t("default")},[a,i]=(0,r.useState)(null),[l,c]=(0,r.useState)(!1),{startRecording:s,stopRecording:d,togglePauseResume:u,recordingBlob:m,isRecording:p,isPaused:f,recordingTime:h,mediaRecorder:g}=(0,fe.C)(),E=(0,r.useRef)(new se.m),[A,b]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{m&&(b(!0),async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mp3";const n=E.current;await n.load();const r="input.webm",a="output.".concat(t);n.writeFile(r,new Uint8Array(await e.arrayBuffer())),await n.exec(["-i",r,a]);const i=await n.readFile(a);return new Blob([i.buffer],{type:"audio/".concat(t)})}(m).then((e=>{i(e)})).finally((()=>{b(!1)})))}),[m]),r.createElement(M.A,{sx:e=>({...le(e)}),alignItems:"center",justifyContent:"center",direction:"row"},r.createElement(M.A,{px:1.5,py:.75,height:"100%",position:"relative",justifyContent:"space-between"},r.createElement(o.A,null,r.createElement(W.A,{variant:"body1Bold",fontSize:14,noWrap:!0},"Record & Send Voice Note")),r.createElement(M.A,{direction:"row",spacing:1.5,alignItems:"center"},a?r.createElement(Pe,{audioSrc:URL.createObjectURL(a)}):r.createElement(be,{recordingTime:h,mediaRecorder:g}),!a&&r.createElement(Z.A,{variant:"contained",color:"primary",disabled:A,sx:{height:40,fontWeight:500,...p&&{backgroundColor:e=>{let{palette:t}=e;return"".concat(t.text.primary," !important")}}},startIcon:p?r.createElement(me.A,null):r.createElement(de.A,null),onClick:()=>{p?d():s()}},p?"Stop":"Record"),a&&r.createElement(Z.A,{variant:"outlined",disabled:l,sx:{height:40,fontWeight:500,px:2},startIcon:r.createElement(pe.A,null),onClick:()=>{i(null),s()}},"Redo"),r.createElement(Z.A,{variant:"contained",sx:{height:40,px:1.5,fontWeight:500},startIcon:r.createElement(ue.A,null),disabled:p||!a||l,onClick:()=>{a&&(c(!0),(0,Me.Ug)(a).then((()=>{n(),i(null)})).finally((()=>{c(!1)})))}},"Send")),r.createElement(oe.A,{onCloseDetail:n})))};var We=n(750);const Ue=function(e){const{item:t,currentPlayingIndex:n,setCurrentPlayingIndex:a,defaultCurrentTime:i,setDefaultCurrentTime:o}=e,l=("VoiceNote"===t.type||"CallHeld"===t.type)&&t.storageUrl&&n!==t.id,c=new Date(t.createdAt),s=c.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),d=c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric"}),u="".concat(s,", ").concat(d);return r.createElement(M.A,{width:"100%",height:"100%"},r.createElement(M.A,{direction:"row",alignItems:"center",spacing:.75},r.createElement(W.A,{variant:"body2",fontSize:14,fontWeight:600},(e=>{switch(e){case"VoiceNote":return"Voice Note";case"CallScheduled":return"Call Scheduled";case"CallHeld":return"Call Recording";case"MissedCall":return"Missed Call";default:return""}})(t.type)),l&&r.createElement(ve.A,{sx:{p:0},color:"secondary",onClick:()=>{a(t.id),o(0)}},r.createElement(xe.A,{sx:{width:16,height:16}}))),r.createElement(M.A,{flex:1},n===t.id?r.createElement(M.A,{width:"100%"},r.createElement(Re,{defaultCurrentTime:i,setDefaultCurrentTime:o,autoPlay:n===t.id&&0===i,audioSrc:t.storageUrl,audioType:"url",isCurrentPlaying:n===t.id,index:t.id,onPlay:e=>{a(e),o(0)},onStop:()=>{a(null),o(0)},onClose:()=>{a(null),o(0)},hideVolumeSlider:!0})):r.createElement(r.Fragment,null,r.createElement(W.A,{variant:"body2",fontSize:14,color:"text.secondary"},u),r.createElement(W.A,{variant:"body2",fontSize:14,color:"text.secondary",fontStyle:"italic"},(e=>{const{sender:t,receiver:n,type:r,isParent:a}=e,i=a?t:n;switch(r){case"VoiceNote":case"MissedCall":return a?"By ".concat(i):"You";case"CallScheduled":case"CallHeld":return"With ".concat(i);default:return""}})(t)))))},Be=e=>({...w(e,y.A.getState().widgetPosition,108,20,"fit-content",x,"visible","fixed","detail"),border:"1px solid ".concat(e.palette.divider)}),ze=(e,t,n,a,i)=>r.createElement(Ue,{item:e,currentPlayingIndex:t,setCurrentPlayingIndex:n,defaultCurrentTime:a,setDefaultCurrentTime:i}),De=function(){const e=(0,y.A)((e=>e.setWidgetDetailOpen)),t=(0,y.A)((e=>e.setWidgetLauncher)),n=(0,y.A)((e=>e.fetchTimelineEvents)),a=(0,y.A)((e=>e.timelineEvents));(0,r.useEffect)((()=>{n().then((()=>{(0,Me.H3)()}))}),[]);const i=(0,y.A)((e=>e.isTimelineEventsLoading));return r.createElement(M.A,{sx:e=>({...Be(e)}),alignItems:"center",justifyContent:"center",direction:"row"},i?r.createElement(W.A,{px:4,fontSize:14},"Loading..."):r.createElement(We.A,{items:a,ItemNode:ze,onWidgetDetailClose:()=>{e(!1),t("default")}}))};var Oe=n(538),Le=n(3754),je=n(4115),Ne=n(1589),_e=n(1783);function Fe(e){const{btnMode:t,children:n,onBtnClick:a,disabled:i}=e;return r.createElement(ve.A,{size:"small",color:"secondary",sx:e=>"on"===t?(e=>({color:"".concat(e.palette.secondary.contrastText," !important"),background:"".concat(e.palette.secondary.main," !important"),"&:hover":{background:"".concat((0,d.X4)(e.palette.secondary.main,.9)," !important")}}))(e):(e=>({background:"".concat((0,d.X4)(e.palette.secondary.main,.12)," !important"),"&:hover":{background:"".concat((0,d.X4)(e.palette.secondary.main,.24)," !important")}}))(e),onClick:a,disabled:i},n)}Fe.defaultProps={disabled:!1};const Ve=Fe,Xe=function(){const{meeting:e}=(0,Ne.xg)(),t=(0,Ne.zf)((e=>e.self.audioEnabled));return r.createElement(o.A,null,r.createElement(Ve,{btnMode:t?"on":"off",onBtnClick:async()=>{let n;return n=t?await e.self.disableAudio():await e.self.enableAudio(),n}},t?r.createElement(X.A,null):r.createElement(_e.A,null)))};var He=n(6493),Je=n(1756);const Ye=function(){const{meeting:e}=(0,Ne.xg)(),t=(0,Ne.zf)((e=>e.self.videoEnabled));return r.createElement(o.A,null,r.createElement(Ve,{btnMode:t?"on":"off",onBtnClick:()=>(async()=>{let n;return n=t?await e.self.disableVideo():await e.self.enableVideo(),n})()},t?r.createElement(He.A,null):r.createElement(Je.A,null)))};var qe=n(8636);const Ke=function(){const{meeting:e}=(0,Ne.xg)(),t=(0,Ne.zf)((e=>e.self.roomJoined)),n=(0,Ne.zf)((e=>e.self.screenShareEnabled)),a=(0,Ne.zf)((e=>e.participants.joined.toArray().filter((e=>e.screenShareEnabled))));return r.createElement(o.A,null,t&&r.createElement(Ve,{btnMode:n?"on":"off",disabled:Boolean(null==a?void 0:a.length),onBtnClick:async()=>{let t;return t=n?await e.self.disableScreenShare():await e.self.enableScreenShare(),t}},r.createElement(qe.A,null)))};var Qe=n(7195);const Ge=function(){const{meeting:e}=(0,Ne.xg)(),t=(0,Ne.zf)((e=>e.self.roomJoined)),n=(0,re.A)((e=>e.endMeeting)),a=(0,re.A)((e=>e.callInitiatedBy)),i=(0,re.A)((e=>e.callId)),l=(0,re.A)((e=>e.isCallRinging));return r.createElement(o.A,null,t&&r.createElement(ve.A,{size:"small",color:"secondary",sx:e=>({color:"".concat(e.palette.error.contrastText," !important"),background:"".concat(e.palette.error.main," !important"),"&:hover":{background:"".concat((0,d.X4)(e.palette.error.main,.9)," !important")}}),onClick:async()=>{"endUser"===a&&l&&i&&(0,Me.zQ)("mark_as_missed",i);const t=await e.leave();return n(),t}},r.createElement(Qe.A,null)))};var Ze=n(8239);function $e(e){const{participants:t,ringingVideoParticipantTile:n,offlineParticipantTile:a,videoParticipantTileNode:i,screenShareParticipant:o,screenShareViewNode:l}=e;let c=0;n&&a?c=2:(n||a)&&(c=1);const s=t.length+c;return r.createElement(Ze.Ay,{container:!0,columns:12,spacing:1,sx:{width:"100%"}},o?r.createElement(r.Fragment,null,r.createElement(Ze.Ay,{item:!0,xs:8},o&&l(o)),r.createElement(Ze.Ay,{item:!0,xs:4,display:"flex",flexDirection:"column",justifyContent:"center"},Boolean(n)&&r.createElement(Ze.Ay,{item:!0,xs:12,display:"flex",alignItems:"center"},n),Boolean(a)&&r.createElement(Ze.Ay,{item:!0,xs:12,display:"flex",alignItems:"center"},a),null==t?void 0:t.map((e=>r.createElement(Ze.Ay,{item:!0,xs:12,key:"call-grid-".concat(e.id),display:"flex",alignItems:"center"},i(e)))))):r.createElement(r.Fragment,null,Boolean(n)&&r.createElement(Ze.Ay,{item:!0,xs:12/s},n),Boolean(a)&&r.createElement(Ze.Ay,{item:!0,xs:12/s},a),null==t?void 0:t.map((e=>r.createElement(Ze.Ay,{item:!0,xs:12/s,key:"call-grid-".concat(e.id)},i(e))))))}$e.defaultProps={ringingVideoParticipantTile:null,offlineParticipantTile:null};const et=$e;function tt(e){const{dimensions:t,participantId:n,participantName:a,isSelf:i,screenShareEnabled:l,screenShareTracks:c,borderRadius:s}=e,{meeting:u}=(0,Ne.xg)(),m=r.useRef(null),p=r.useRef(null);return(0,r.useEffect)((()=>{if(n&&l&&c.video){const e=new MediaStream;e.addTrack(c.video),m.current&&(m.current.srcObject=e)}}),[l,c.video,n]),(0,r.useEffect)((()=>{if(n&&!i&&l&&c.audio){const e=new MediaStream;e.addTrack(c.audio),p.current&&(p.current.srcObject=e)}}),[i,l,c.audio,n]),r.createElement(o.A,{sx:{display:"flex",overflow:"hidden",position:"relative",background:e=>{let{palette:t}=e;return t.common.black},...t,borderRadius:s&&{rounded:"8px",square:"0px",extraRounded:"16px"}[s]}},l&&!i&&r.createElement(o.A,{sx:{width:"100%",objectFit:"contain"},component:"audio",id:"screen-share-audio-".concat(n),ref:p,autoPlay:!0,playsInline:!0}),r.createElement(o.A,{sx:{width:"100%",objectFit:"contain"},component:"video",id:"screen-share-video-".concat(n),ref:m,autoPlay:!0,playsInline:!0}),l&&i&&r.createElement(o.A,null,r.createElement(o.A,{sx:{position:"absolute",left:0,right:0,top:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",background:e=>{let{palette:t}=e;return(0,d.X4)(t.common.black,.5)}}},r.createElement(Z.A,{variant:"contained",color:"error",onClick:async()=>await u.self.disableScreenShare()},"Stop Sharing"))),r.createElement(o.A,{sx:{position:"absolute",bottom:0,left:0,right:0,padding:"4px",display:"flex",color:e=>{let{palette:t}=e;return t.common.white}}},r.createElement(M.A,{direction:"row",sx:{background:e=>{let{palette:t}=e;return(0,d.X4)(t.common.black,.5)},maxWidth:"50%",p:.5,borderRadius:e=>{let{shape:t}=e;return"".concat(t.borderRadius,"px")}}},a&&r.createElement(W.A,{variant:"subtitle2",noWrap:!0},a,i&&" (You)"))))}tt.defaultProps={dimensions:{width:200,aspectRatio:"16 / 9"},participantName:"",isSelf:!1,borderRadius:"rounded"};const nt=tt;var rt=n(8393),at=n(2250),it=n(1809);function ot(e){const{dimensions:t,participantId:n,participantName:a,isSelf:i,videoEnabled:l,videoTrack:c,audioEnabled:s,audioTrack:u,borderRadius:m,hideBottomLabel:p}=e,f=r.useRef(null),h=r.useRef(null);return(0,r.useEffect)((()=>{if(n&&l&&c){const e=new MediaStream;e.addTrack(c),f.current&&(f.current.srcObject=e)}}),[l,c,n]),(0,r.useEffect)((()=>{if(n&&!i&&s&&u){const e=new MediaStream;e.addTrack(u),h.current&&(h.current.srcObject=e)}}),[i,s,u,n]),r.createElement(o.A,{sx:{display:"flex",overflow:"hidden",position:"relative",background:e=>{let{palette:t}=e;return"".concat(i?(0,d.X4)(t.secondary.main,.12):(0,d.X4)(t.primary.main,.12))},...t,borderRadius:m&&{rounded:"8px",square:"0px",extraRounded:"16px"}[m]}},s&&!i&&r.createElement(o.A,{sx:{width:"100%",objectFit:"cover"},component:"audio",id:"audio-".concat(n),ref:h,autoPlay:!0,playsInline:!0}),l?r.createElement(o.A,{sx:{width:"100%",objectFit:"cover"},component:"video",id:"video-".concat(n),ref:f,autoPlay:!0,playsInline:!0}):r.createElement(o.A,{sx:{width:"100%",height:"100%",display:"flex"}},r.createElement(o.A,{height:"40%",sx:{aspectRatio:1,margin:"auto"}},r.createElement(rt.A,{src:"img-url",alt:a,sx:{color:e=>{let{palette:t}=e;return t.text.primary},backgroundColor:e=>{let{palette:t}=e;return t.background.paper},width:"100%",height:"100%",aspectRatio:1}}))),!p&&r.createElement(o.A,{sx:{position:"absolute",bottom:0,left:0,right:0,padding:"4px",display:"flex",color:e=>{let{palette:t}=e;return t.common.white}}},r.createElement(M.A,{direction:"row",sx:{background:e=>{let{palette:t}=e;return(0,d.X4)(t.common.black,.5)},maxWidth:"50%",p:.5,borderRadius:e=>{let{shape:t}=e;return"".concat(t.borderRadius,"px")}}},s?r.createElement(at.A,{fontSize:"small"}):r.createElement(it.A,{fontSize:"small"}),a&&r.createElement(W.A,{variant:"subtitle2",noWrap:!0},a,i&&" (You)"))))}ot.defaultProps={dimensions:{width:200,aspectRatio:"16 / 9"},participantName:"",isSelf:!1,borderRadius:"rounded",videoTrack:void 0,audioTrack:void 0,hideBottomLabel:!1};const lt=ot;function ct(e){const{startTimestamp:t,sx:n}=e,[a,i]=(0,r.useState)("00:00");return(0,r.useEffect)((()=>{const e=()=>{const e=Date.now(),n=new Date(t).getTime(),r=Math.floor((e-n)/1e3);i(Ae(r))},n=setInterval((()=>{e()}),1e3);return e(),()=>clearInterval(n)}),[t]),r.createElement(o.A,null,r.createElement(W.A,{variant:"body2",sx:e=>n?n(e):{}},a,"s"))}ct.defaultProps={sx:()=>({})};const st=ct,dt=function(){const e=(0,Ne.zf)((e=>e.self.roomJoined)),t=(0,re.A)((e=>e.recStartTimestamp));return r.createElement(o.A,null,e&&Boolean(t)&&r.createElement(M.A,{direction:"row",spacing:.5,alignItems:"center"},r.createElement(de.A,{color:"error",sx:{height:16,width:16,animation:"blinker 1s cubic-bezier(.5, 0, 1, 1) infinite alternate","@keyframes blinker":{"0%":{opacity:1},"100%":{opacity:0}}}}),r.createElement(st,{startTimestamp:t,sx:e=>({fontSize:14,fontWeight:500,color:"text.secondary"})})))},ut=function(){const e=(0,re.A)((e=>e.isMeetingStarted)),t=(0,re.A)((e=>e.isCallRinging)),n=(0,re.A)((e=>e.isUserJoined));let a="";return e&&(n||(a=t?"Ringing...":"Connecting...")),a?r.createElement(M.A,{direction:"row",maxWidth:120},r.createElement(W.A,{fontSize:12,fontWeight:500,variant:"body2",color:"text.secondary",noWrap:!0},a)):null};function mt(e){const{dimensions:t,borderRadius:n}=e;return r.createElement(o.A,{sx:{display:"flex",overflow:"hidden",position:"relative",background:e=>{let{palette:t}=e;return t.background.paper},...t,borderRadius:n&&{rounded:"8px",square:"0px",extraRounded:"16px"}[n],border:e=>{let{palette:t}=e;return"1px solid ".concat((0,d.X4)(t.secondary.main,.54))}}},r.createElement(M.A,{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",spacing:.75},r.createElement(W.A,{fontSize:14,fontWeight:600,variant:"body2",noWrap:!0},"Connecting"),r.createElement(W.A,{fontSize:12,variant:"body2",color:"textSecondary",noWrap:!0},"Notification Sent...")))}mt.defaultProps={dimensions:{width:200,aspectRatio:"16 / 9"},borderRadius:"rounded"};const pt=mt,ft=function(){const e=(0,re.A)((e=>e.isMeetingStarted)),t=((0,re.A)((e=>e.isCallRinging)),(0,re.A)((e=>e.isUserJoined)));return e&&!t?r.createElement(pt,{dimensions:{width:"100%",aspectRatio:"16 / 9"}}):null},ht=function(){const e=(0,re.A)((e=>e.isMeetingStarted)),t=((0,re.A)((e=>e.isCallRinging)),(0,re.A)((e=>e.isUserJoined))),n=(0,re.A)((e=>e.isUserDisconnected));return e&&t&&n?r.createElement(pt,{dimensions:{width:"100%",aspectRatio:"16 / 9"}}):null};function gt(e){const{isFullScreen:t}=e,{meeting:n}=(0,Ne.xg)(),a=(0,Ne.zf)((e=>e.self.id)),i=(0,Ne.zf)((e=>e.self.name)),o=(0,Ne.zf)((e=>e.self.videoEnabled)),l=(0,Ne.zf)((e=>e.self.videoTrack)),c=(0,Ne.zf)((e=>e.self.audioEnabled)),s=(0,Ne.zf)((e=>e.self.audioTrack)),d=(0,Ne.zf)((e=>e.self.screenShareEnabled)),u=(0,Ne.zf)((e=>e.self.screenShareTracks)),m=(0,Ne.zf)((e=>e.participants.active.toArray())),p=(0,Ne.zf)((e=>e.participants.joined.toArray().filter((e=>e.screenShareEnabled))[0])),f=(0,re.A)((e=>e.recStartTimestamp)),h=(0,re.A)((e=>e.setRecStartTimestamp)),g=(0,Ne.zf)((e=>e.recording.recordingState));(0,r.useEffect)((()=>{if("RECORDING"===g&&!f){const e=new Date;h(e.toISOString())}}),[g]);const E=(0,r.useMemo)((()=>p?{...p,isSelf:!1}:{id:a,name:i,videoEnabled:o,videoTrack:l,audioEnabled:c,audioTrack:s,screenShareEnabled:d,screenShareTracks:u,isSelf:!0}),[p,a,i,o,l,c,s,d,u]),A=(0,r.useMemo)((()=>{const e={id:a,name:i,isSelf:!0,videoEnabled:o,videoTrack:l,audioEnabled:c,audioTrack:s,screenShareEnabled:d,screenShareTracks:u};return[...m.map((e=>({...e,isSelf:!1}))),e]}),[m,a,i,o,l,c,s,d,u]),b=(0,re.A)((e=>e.isCallRinging)),v=(0,re.A)((e=>e.isUserJoined)),y=(0,re.A)((e=>e.endMeeting));(0,r.useEffect)((()=>{let e;return!v&&b&&(e=setTimeout((()=>{v||(0,Me.zQ)("mark_as_missed").finally((()=>{n.leave().then((()=>{y()}))}))}),3e4)),()=>clearTimeout(e)}),[b,v]);const x=K("https://cdn.pixabay.com/download/audio/2022/03/09/audio_838aec5a23.mp3?filename=japaneseringing-25657.mp3",{loop:!0});(0,r.useEffect)((()=>{b?x.playSound():x.stopSound()}),[b]);const S=(0,re.A)((e=>e.callInitiatedBy)),w=(0,re.A)((e=>e.callId));(0,r.useEffect)((()=>{const e=()=>{b&&"endUser"===S&&(0,Me.zQ)("mark_as_missed",w)};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[b,S,w]);const C=(0,Ne.zf)((e=>e.participants.active.size)),k=(0,re.A)((e=>e.isUserDisconnected)),T=(0,re.A)((e=>e.setIsUserJoined)),R=(0,re.A)((e=>e.setIsUserDisconnected));return(0,r.useEffect)((()=>{C?(k&&R(!1),T(!0)):v&&(R(!0),n.leave().then((()=>{y()})))}),[C]),r.createElement(M.A,{spacing:2,flex:1,position:"relative"},r.createElement(M.A,{flex:1,alignItems:"center",justifyContent:"center"},r.createElement(et,{participants:A,videoParticipantTileNode:e=>(e=>r.createElement(lt,{key:e.id,dimensions:{width:"100%",aspectRatio:"16 / 9"},isSelf:e.isSelf,participantId:e.id,participantName:e.name,videoEnabled:e.videoEnabled,videoTrack:e.videoTrack,audioEnabled:e.audioEnabled,audioTrack:e.audioTrack}))(e),ringingVideoParticipantTile:ft(),offlineParticipantTile:ht(),screenShareParticipant:(d||p)&&E,screenShareViewNode:e=>(e=>r.createElement(nt,{key:e.id,dimensions:{width:"100%",aspectRatio:"16 / 9"},participantId:e.id,participantName:e.name,isSelf:e.isSelf,screenShareEnabled:e.screenShareEnabled,screenShareTracks:e.screenShareTracks}))(e)})),r.createElement(M.A,{width:"100%",alignItems:"center",justifyContent:"center",spacing:3,direction:"row"},r.createElement(Xe,null),r.createElement(Ye,null),r.createElement(Ke,null),r.createElement(Ge,null)),r.createElement(M.A,{position:"absolute",bottom:10,left:4},r.createElement(ut,null)),r.createElement(M.A,{position:"absolute",bottom:8,right:4},r.createElement(dt,null)))}gt.defaultProps={isFullScreen:!1};const Et=gt,At=function(){const[e,t]=(0,Ne.fG)(),[n,a]=(0,r.useState)(!1),i=r.createRef();(0,r.useEffect)((()=>{const e=()=>{a(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}}),[]);const l=(0,re.A)((e=>e.meetingAuthToken)),c=(0,re.A)((e=>e.isMeetingStarted)),s=(0,re.A)((e=>e.setIsMeetingStarted)),d=((0,re.A)((e=>e.isUserJoined)),(0,re.A)((e=>e.meetingInitType)));return(0,r.useEffect)((()=>{l&&t({authToken:l,defaults:{audio:!0,video:"video"===d,screenShare:{displaySurface:"browser"}}}).then((e=>{e&&(e.join(),s(!0))}))}),[l]),l&&c?r.createElement(Oe.A,{sx:e=>((e,t)=>({backgroundColor:t?e.palette.background.paper:"transparent",width:"100%",height:"100%"}))(e,n),ref:i,elevation:0},r.createElement(Ne.wl,{value:e},r.createElement(M.A,{width:"100%",height:"100%",px:"5%",py:"5%",spacing:1},r.createElement(M.A,{direction:"row"},r.createElement(M.A,{flex:1}),r.createElement(o.A,null,r.createElement(ve.A,{onClick:()=>{var e,t;!n&&null!=i&&null!==(e=i.current)&&void 0!==e&&e.requestFullscreen&&(i.current.requestFullscreen(),a(!n)),n&&null!==(t=document)&&void 0!==t&&t.exitFullscreen&&(document.exitFullscreen(),a(!n))},color:"inherit"},n?r.createElement(je.A,{sx:{width:16,height:16}}):r.createElement(Le.A,{sx:{width:16,height:16}})))),r.createElement(Et,{isFullScreen:n})))):null},bt=e=>({...w(e,y.A.getState().widgetPosition,20,20,426,"fit-content","visible","fixed","detail"),border:"1px solid ".concat(e.palette.divider)}),vt=function(){(0,y.A)((e=>e.setWidgetDetailOpen)),(0,y.A)((e=>e.setWidgetLauncher));const e=(0,re.A)((e=>e.isMeetingLoading));return r.createElement(M.A,{sx:e=>({...bt(e)}),alignItems:"center",justifyContent:"center",direction:"row"},e?"Please wait while we connect the call":r.createElement(At,null))};var yt=n(5979);const xt=e=>({...w(e,y.A.getState().widgetPosition,108,20,"fit-content",x,"visible","fixed","detail"),border:"1px solid ".concat(e.palette.divider)}),St=function(){const e=(0,y.A)((e=>e.agentName))||"Agent",t=(0,y.A)((e=>e.teamName)),n=(0,re.A)((e=>e.startMeeting)),a=(0,y.A)((e=>e.setWidgetLauncher)),i=(0,re.A)((e=>e.setMeetingInitType));return(0,y.A)((e=>e.setWidgetDetailOpen)),r.createElement(M.A,{sx:e=>({...xt(e)}),alignItems:"center",justifyContent:"center",direction:"row"},r.createElement(M.A,{px:1.5,py:.75,height:"100%",position:"relative",justifyContent:"space-between"},r.createElement(o.A,null,r.createElement(W.A,{variant:"body1Bold",fontSize:14,noWrap:!0},e&&"Call from ".concat(e," in ").concat(t),"Â ")),r.createElement(M.A,{direction:"row",spacing:2,height:"100%",alignItems:"center",justifyContent:"center",position:"relative"},r.createElement(Z.A,{variant:"contained",sx:{height:36,fontWeight:500,px:2},startIcon:r.createElement(He.A,null),onClick:()=>{n("get"),i("video"),a("inCall")}},"Accept Video Call"),r.createElement(Z.A,{variant:"contained",sx:{height:36,fontWeight:500,px:2},startIcon:r.createElement(yt.A,null),onClick:()=>{n("get"),i("audio"),a("inCall")}},"Accept Voice Call"),r.createElement(Z.A,{variant:"outlined",color:"error",sx:{height:36,fontWeight:500,px:2},onClick:()=>{a("declinedIncomingCall")}},"Decline"))))},wt=function(){const e=(0,y.A)((e=>e.newUnreadEvent)),t=(0,y.A)((e=>e.teamName)),n=(0,y.A)((e=>e.setWidgetDetailOpen)),a=(0,y.A)((e=>e.setWidgetLauncher)),i=(0,y.A)((e=>e.setNewUnreadEvent)),l=(0,y.A)((e=>e.fetchUnreadEvents));(0,r.useEffect)((()=>{null!=e&&e.id&&(0,Me.H3)(null==e?void 0:e.id)}),[]);const[c,s]=(0,r.useState)(null);if(!e)return null;const{id:d="",sender:u="Agent",storageUrl:m=""}=e;return r.createElement(M.A,{sx:e=>({...le(e),width:284}),alignItems:"center",direction:"row"},Boolean(e)&&r.createElement(M.A,{px:1.5,py:.75,height:"100%",position:"relative",justifyContent:"space-between",width:"100%"},r.createElement(o.A,null,r.createElement(W.A,{fontSize:14,noWrap:!0},u," from ",t)),r.createElement(Re,{audioSrc:m,isCurrentPlaying:c===d,index:d,onPlay:e=>(e=>{s(e),(0,Me.VZ)(e)})(e),onStop:()=>s(null)})),r.createElement(oe.A,{onCloseDetail:()=>{i(null),l().finally((()=>{n(!1),a("default")}))}}))},Ct=function(){const e=(0,y.A)((e=>e.newUnreadEvent)),t=(0,y.A)((e=>e.teamName)),n=(0,y.A)((e=>e.setWidgetDetailOpen)),a=(0,y.A)((e=>e.setWidgetLauncher)),i=(0,y.A)((e=>e.setNewUnreadEvent)),l=(0,y.A)((e=>e.fetchUnreadEvents));(0,r.useEffect)((()=>{null!=e&&e.id&&(0,Me.H3)(null==e?void 0:e.id)}),[]);const c=()=>{i(null),l()};if(!e)return null;const{sender:s="Agent"}=e;return r.createElement(M.A,{sx:e=>({...le(e)}),alignItems:"center",justifyContent:"center",direction:"row"},r.createElement(M.A,{px:1.5,py:.75,height:"100%",position:"relative",justifyContent:"space-between"},r.createElement(o.A,null,r.createElement(W.A,{variant:"body1Bold",fontSize:14,noWrap:!0},"Missed call from ",s," in ",t)),r.createElement(ie,{hideTimelineBtn:!0,onCallBtnClick:c,onScheduleBtnClick:c,onVoiceNoteBtnClick:c,onTimelineBtnClick:c}),r.createElement(oe.A,{onCloseDetail:()=>{i(null),l().finally((()=>{n(!1),a("default")}))}})))},kt=function(){const e=(0,y.A)((e=>e.setWidgetDetailOpen)),t=(0,y.A)((e=>e.setWidgetLauncher)),n=(0,y.A)((e=>e.teamName)),a=(0,y.A)((e=>e.agentName));return r.createElement(M.A,{sx:e=>({...le(e)}),alignItems:"center",justifyContent:"center",direction:"row"},r.createElement(M.A,{px:1.5,py:.75,height:"100%",position:"relative",justifyContent:"space-between"},r.createElement(o.A,null,r.createElement(W.A,{variant:"body1Bold",fontSize:14,noWrap:!0},"You declined call from ",a||"Agent"," in ",n)),r.createElement(ie,{hideCallBtn:!0,hideTimelineBtn:!0}),r.createElement(oe.A,{onCloseDetail:()=>{e(!1),t("default")}})))},Tt=function(){const e=(0,y.A)((e=>e.widgetDetailOpen)),t=(0,y.A)((e=>e.widgetLauncher));if(e)switch(t){case"default":return r.createElement(ce,null);case"voiceNote":return r.createElement(wt,null);case"missedCall":return r.createElement(Ct,null);case"voiceRecording":return r.createElement(Ie,null);case"aboutToReceiveCall":case"none":default:return null;case"timeline":return r.createElement(De,null);case"ringing":return r.createElement(St,null);case"inCall":return r.createElement(vt,null);case"declinedIncomingCall":return r.createElement(kt,null)}return null};var Rt=n(1621),Pt=n(7134),Mt=n(6479),It=n.n(Mt),Wt=n(4498),Ut=n(1185);const{API_VERSION:Bt,API_BASE_URL:zt}=Wt.A;class Dt{constructor(e,t,n){this.PUSHER_APP_KEY=e,this.PUSHER_APP_CLUSTER=t,this.USER_TOKEN=n,Dt.instance||(this.client=new(It())(this.PUSHER_APP_KEY,{cluster:this.PUSHER_APP_CLUSTER,authEndpoint:"".concat(Ut.JT),auth:{headers:{"X-User-Token":this.USER_TOKEN}}}),console.log(this.client),Dt.instance=this)}static getClient(e,t,n){return this.instance||(this.instance=new Dt(e,t,n)),this.instance.client}}const{PUSHER_APP_KEY:Ot,PUSHER_APP_CLUSTER:Lt}=Wt.A,jt={pusher:It()||null,channels:It().channels||null,endUsersInteracting:[],endUsers:[]},Nt=(0,Rt.vt)()((0,Pt.lt)(((e,t)=>({channels:null,pusher:null,endUsersInteracting:[],endUsers:[],initializeChannel:(n,r,a)=>{if(!n||!r||!a)return void console.warn("Missing parameters for initializing Pusher channel.");console.log("pusher_init_check",Ot,Lt,a);let{pusher:i}=t();i||(console.log("pusher_init_check",Ot,Lt,a),i=Dt.getClient(Ot,Lt,a),console.log("pusher_1",i),e({pusher:i}),console.log("pusher_2",i));const o=i.subscribe("".concat(r,"-").concat(n));e((e=>({channels:{...e.channels,["".concat(r,"-").concat(n)]:o}})))},bindEvent:(e,n,r)=>{const{channels:a}=t(),i=a[e];null==i||i.bind(n,r)},triggerEvent:(e,n,r)=>{console.log("sending...",e,n,r);const{pusher:a}=t();null==a||a.send_event("client-".concat(n),r,e)},unbindEvent:(e,n,r)=>{const{channels:a}=t(),i=a[e];null==i||i.unbind(n,r)},cleanupChannel:n=>{const{channels:r}=t(),a=r[n];a&&(a.unsubscribe(),e((e=>{const t={...e.channels};return delete t[n],{channels:t}})))},cleanupAllChannels:()=>{const{channels:n}=t();Object.values(n).forEach((e=>{e.unsubscribe()})),e({channels:{}})},updateEndUsersInteracting:t=>{e((e=>({endUsersInteracting:[...jt.endUsersInteracting,t]})))},updateEndUsers:t=>{e((e=>({endUsers:[...jt.endUsers,t]})))}})))),_t=Nt,Ft=e=>btoa(e),Vt=function(){const e=(0,y.A)((e=>e.orgKey)),t=(0,y.A)((e=>e.widgetLauncher)),n=function(){const[e,t]=(0,r.useState)(!document.hidden);return(0,r.useEffect)((()=>{const e=()=>{t(!document.hidden)};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[]),e}(),a=e,i=(0,y.A)((e=>e.endUserId)),o=(0,y.A)((e=>e.widgetDetailOpen)),l=(0,y.A)((e=>e.setWidgetLauncher)),c=(0,y.A)((e=>e.fetchUnreadEvents)),s=(0,y.A)((e=>e.setAgentName)),d=K("https://cdn.pixabay.com/download/audio/2024/04/01/audio_e939eebbb1.mp3?filename=level-up-3-199576.mp3"),u=i,m="".concat(a,"-").concat("widget"),p="".concat(a,"-online"),f="".concat(a,"-").concat(Ft(String(u)));return(0,r.useEffect)((()=>(u&&a&&(_t.getState().initializeChannel(a,"presence",Ft(String(u))),_t.getState().bindEvent("presence-".concat(a),"pusher:subscription_succeeded",(e=>{console.log("connected to pingbase headquaters <> Presence")})),_t.getState().initializeChannel(f,"private",Ft(String(u))),_t.getState().bindEvent("private-".concat(f),"client-event",(e=>{const{source_event_type:t,sender:n}=e;"call"===t?(d.playSound(),re.A.setState({callId:e.id}),l("aboutToReceiveCall"),s(n)):("voice_note"===t||"missed-call"===t)&&(d.playSound(),c())}))),()=>{u&&a&&(_t.getState().cleanupChannel("presence-".concat(a)),_t.getState().cleanupChannel("private-".concat(f)))})),[a,u]),(0,r.useEffect)((()=>{u&&a&&(o||"aboutToReceiveCall"===t?_t.getState().initializeChannel(m,"presence",Ft(String(u))):_t.getState().cleanupChannel("presence-".concat(m)))}),[o,u,a]),(0,r.useEffect)((()=>{u&&a&&(n?_t.getState().initializeChannel(p,"presence",Ft(String(u))):_t.getState().cleanupChannel("presence-".concat(p)))}),[n]),r.createElement("div",null," ")},Xt=function(e){let{children:t}=e;const n=(0,y.A)((e=>e.fetchUnreadEvents));return(0,r.useEffect)((()=>{n()}),[]),r.createElement(o.A,null,t)},Ht=function(e){var t,n,m,g,x,S;let{shadowWidgetRootElement:w}=e;const C=(0,y.A)((e=>e.themeMode)),k=(0,l.A)((e=>{const t=((e,t)=>({...t,mode:e,..."light"===e?{primary:{main:"#34A974"},secondary:{main:"#524C91"},error:{main:"#E01D5A"},tonalOffset:{light:.1,dark:.1},text:{primary:"#0D0C22",secondary:(0,d.X4)("#0D0C22",.54),disabled:(0,d.X4)("#0D0C22",.37)},contrastThreshold:2.96}:{primary:{main:"#34A974"},secondary:{main:"#524C91"},text:{primary:"#fff",secondary:s.A[200]}}}))(e,(0,c.A)({palette:{mode:e}}).palette);return(0,c.A)({palette:t,typography:u(t),shape:{borderRadius:8},components:{MuiScopedCssBaseline:{styleOverrides:{root:{backgroundColor:"transparent",margin:"0 !important",padding:"0 !important",boxSizing:"border-box !important"}}},MuiButton:p(t),MuiTypography:{defaultProps:{variantMapping:{body1Bold:"p",caption2:"p"}}},MuiAppBar:f(t),MuiFormControlLabel:{styleOverrides:{root:{},asterisk:{display:"none"}},defaultProps:{}},MuiFormHelperText:{styleOverrides:{root:{marginLeft:0}},defaultProps:{}},MuiTextField:h(t),MuiSelect:E(t),MuiSwitch:A(t),MuiCheckbox:{styleOverrides:{root:{}},defaultProps:{}},MuiTableCell:b(t),MuiTableRow:v(t),MuiTabs:{styleOverrides:{root:e=>{let{theme:t}=e;return{borderBottom:"1px solid ".concat(t.palette.text.primary),"& .MuiTabs-indicator":{display:"none"},minHeight:40,height:40}}},defaultProps:{}},MuiTab:{styleOverrides:{root:e=>{let{theme:t}=e;return{textTransform:"none",minWidth:0,[t.breakpoints.up("sm")]:{minWidth:0},marginRight:t.spacing(.5),color:t.palette.text.primary,background:"linear-gradient(126deg, ".concat((0,d.X4)(t.palette.primary.main,.06)," 15.93%, ").concat((0,d.X4)(t.palette.secondary.main,.06)," 93.42%)"),borderTopLeftRadius:t.shape.borderRadius,borderTopRightRadius:t.shape.borderRadius,"&:hover":{},"&.Mui-selected":{color:t.palette.common.white,background:"linear-gradient(126deg, ".concat(t.palette.primary.main," 15.93%, ").concat(t.palette.secondary.main," 93.42%)")},minHeight:40,height:40}}},defaultProps:{}},MuiSlider:{styleOverrides:{root:e=>{let{theme:t}=e;return{height:6,"& .MuiSlider-thumb":{display:"none"},"& .MuiSlider-track":{border:"none",height:6,minWidth:6}}}},defaultProps:{}}}})})(C)),T={...k,components:{...k.components,MuiPopover:{...null===(t=k.components)||void 0===t?void 0:t.MuiPopover,defaultProps:{...null===(n=k.components)||void 0===n||null===(n=n.MuiPopover)||void 0===n?void 0:n.defaultProps,container:w}},MuiPopper:{...null===(m=k.components)||void 0===m?void 0:m.MuiPopper,defaultProps:{...null===(g=k.components)||void 0===g||null===(g=g.MuiPopper)||void 0===g?void 0:g.defaultProps,container:w}},MuiModal:{...null===(x=k.components)||void 0===x?void 0:x.MuiModal,defaultProps:{...null===(S=k.components)||void 0===S||null===(S=S.MuiModal)||void 0===S?void 0:S.defaultProps,container:w}}}},R=(0,y.A)((e=>e.showWidget)),P=(0,y.A)((e=>e.endUserId)),M=(0,y.A)((e=>e.isOrgDetailsLoading)),I=(0,y.A)((e=>e.newUnreadEvent)),W=(0,y.A)((e=>e.setWidgetLauncher)),U=(0,y.A)((e=>e.widgetDetailOpen));return(0,r.useEffect)((()=>{if(I&&!U){const{type:e}=I;switch(e){case"VoiceNote":W("voiceNote");break;case"MissedCall":W("missedCall")}}}),[I]),!M&&R&&P?r.createElement(a.A,{theme:T},r.createElement(i.A,null,r.createElement(o.A,{className:"app"},r.createElement(Xt,null,r.createElement(G,null),r.createElement(Tt,null),r.createElement(Vt,null))))):null}}}]);